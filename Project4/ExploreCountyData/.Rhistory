ggplot(aes(factor(year),
birth_rate),
data = mean_change_rates) +
geom_jitter( alpha = .3)  +
geom_boxplot( alpha = .5,color = 'blue')+
stat_summary(fun.y = "mean",
geom = "point",
color = "red",
shape = 8,
size = 4)
mean_change_rates <- change_rates %>%
group_by(State, year) %>%
filter(!is.na(birth_rate), !is.na(death_rate)) %>%
summarise(mean_birth_rate = mean(birth_rate),
mean_death_rate = mean(death_rate))
ggplot(aes(factor(year),
mean_birth_rate),
data = mean_change_rates) +
geom_jitter( alpha = .3)  +
geom_boxplot( alpha = .5,color = 'blue')+
stat_summary(fun.y = "mean",
geom = "point",
color = "red",
shape = 8,
size = 4)
ggplot(aes(factor(year),
birth_rate),
data = change_rates) +
geom_jitter( alpha = .3)  +
geom_boxplot( alpha = .5,color = 'blue')+
stat_summary(fun.y = "mean",
geom = "point",
color = "red",
shape = 8,
size = 4)
ggplot(aes(factor(year),
death_rate),
data = change_rates) +
geom_jitter( alpha = .3)  +
geom_boxplot( alpha = .5,color = 'blue')+
stat_summary(fun.y = "mean",
geom = "point",
color = "red",
shape = 8,
size = 4)
ggplot(aes(factor(year),
mean_birth_rate),
data = mean_change_rates) +
geom_jitter( alpha = .3)  +
geom_boxplot( alpha = .5,color = 'blue')+
stat_summary(fun.y = "mean",
geom = "point",
color = "red",
shape = 8,
size = 4)
ggplot(aes(factor(year),
mean_death_rate),
data = mean_change_rates) +
geom_jitter( alpha = .3)  +
geom_boxplot( alpha = .5,color = 'blue')+
stat_summary(fun.y = "mean",
geom = "point",
color = "red",
shape = 8,
size = 4)
map_counties <- map_data('county')
map_counties <- tbl_df(map_counties)
df_counties$Area_Name <- sapply(df_counties$Area_Name, tolower)
map_counties$subregion <- sapply(map_counties$subregion, tolower)
df_counties$Area_Name <- sapply(df_counties$Area_Name,
function (x) gsub('[[:punct:]]', '', x))
map_counties$subregion <- sapply(map_counties$subregion,
function (x) gsub('[[:punct:]]', '', x))
df_counties$Area_Name <- sapply(df_counties$Area_Name, function (x)
gsub(area_identifiers, '', x, ignore.case = TRUE))
map_counties$subregion <- sapply(map_counties$subregion, function (x)
gsub(area_identifiers, '', x, ignore.case = TRUE))
df_counties$Area_Name <- sapply(df_counties$Area_Name,
function (x) gsub('[[:space:]]', '', x))
map_counties$subregion <- sapply(map_counties$subregion,
function (x) gsub('[[:space:]]', '', x))
#match on state and converted subregions. Shouldn't be many that match on both state and subregion even if they end up blank in subregion like park
#df_counties$Area_Name[!(df_counties$Area_Name %in% map_counties$subregion)]
#map_counties$subregion[!(map_counties$subregion %in% df_counties$Area_Name)]
#Need to translate abbreviations to full to match with map_counties
state_translations <- df_states_level %>%
select(State, Area_Name)
state_translations$Area_Name <- sapply(state_translations$Area_Name, tolower)
df_counties$State <- state_translations$Area_Name[match(df_counties$State, state_translations$State)]
df_counties$unemploy_inc_2008 <- df_counties$Unemployment_rate_2008 - df_counties$Unemployment_rate_2007
df_counties$unemploy_inc_2009 <- df_counties$Unemployment_rate_2009 - df_counties$Unemployment_rate_2007
df_counties$unemploy_inc_2010 <- df_counties$Unemployment_rate_2010 - df_counties$Unemployment_rate_2007
df_counties$unemploy_inc_2011 <- df_counties$Unemployment_rate_2011 - df_counties$Unemployment_rate_2007
unemployment_map <- inner_join(df_counties, map_counties, by = c("Area_Name" = "subregion", "State" = "region"))
unemployment_map <- unemployment_map %>%
select(State, Area_Name, lat, long, group,
unemploy_inc_2008:unemploy_inc_2011) %>%
gather(key=year, value=unemploy_inc,
unemploy_inc_2008:unemploy_inc_2011)
unemployment_map$year <- sapply(unemployment_map$year, function(x)
as.numeric(gsub("unemploy_inc_", "", x)))
max_unemployment <- unemployment_map %>%
group_by(State, Area_Name) %>%
summarise(max_inc = max(unemploy_inc))
max_unemployment_map <- inner_join(max_unemployment,
map_counties,
by = c("Area_Name" = "subregion",
"State" = "region"))
ggplot(aes(x=long, y=lat, group=group, fill=max_inc),
data=max_unemployment_map) +
geom_polygon() +
coord_map()
library(gridExtra)
p1 <- ggplot(aes(x=State, y=PCTPOVALL_2014),
data=slice(poverty_order, 27:51)) +
geom_bar(stat='identity', fill="blue3") +
scale_x_discrete(limits=slice(poverty_order,27:51)$State) +
scale_y_continuous(limits=c(0,22)) +
ylab("Poverty Rate") +
theme_bw() +
coord_flip()
p2 <- ggplot(aes(x=State, y=PCTPOVALL_2014),
data=slice(poverty_order, 1:27)) +
geom_bar(stat='identity', fill="blue3") +
scale_x_discrete(limits=slice(poverty_order,1:27)$State) +
scale_y_continuous(limits=c(0,22)) +
ylab("Poverty Rate") +
theme_bw() +
coord_flip()
grid.arrange(p1, p2, ncol=2, top="Poverty Rates by State")
poverty_order
poverty_order %>%
summarise(stddev_poverty_rate = sd(PCTPOVALL_2014))
summarise(stddev_poverty_rate = sd(PCTPOVALL_2014),
poverty_order %>%
summarise(stddev_poverty_rate = sd(PCTPOVALL_2014),
maximum_poverty_rate = max(PCTPOVALL_2014),
minimum_poverty_rate = min(PCTPOVALL_2014))
)
poverty_order %>%
summarise(stddev_poverty_rate = sd(PCTPOVALL_2014),
maximum_poverty_rate = max(PCTPOVALL_2014),
minimum_poverty_rate = min(PCTPOVALL_2014))
21.9-9.2
(21.9-9.2)/3.07
p1 <- ggplot(aes(x=State, y=PCTPOVALL_2014),
data=slice(poverty_order, 27:51)) +
geom_bar(stat='identity', fill="blue3") +
scale_x_discrete(limits=slice(poverty_order,27:51)$State) +
scale_y_continuous(limits=c(0,22), labels=percent_format()) +
ylab("Poverty Rate") +
theme_bw() +
coord_flip()
as.character("asdf")
as.character(12)
p1 <- ggplot(aes(x=State, y=PCTPOVALL_2014),
data=slice(poverty_order, 27:51)) +
geom_bar(stat='identity', fill="blue3") +
scale_x_discrete(limits=slice(poverty_order,27:51)$State) +
scale_y_continuous(limits=c(0,22), labels=percent) +
ylab("Poverty Rate") +
theme_bw() +
coord_flip()
percent <- function(x) {
return paste(as.char(x), "%", sep="")
}
?paste
percent <- function(x) {
return(paste(as.char(x), "%", sep=""))
}
library(gridExtra)
percent <- function(x) {
return(paste(as.char(x), "%", sep=""))
}
p1 <- ggplot(aes(x=State, y=PCTPOVALL_2014),
data=slice(poverty_order, 27:51)) +
geom_bar(stat='identity', fill="blue3") +
scale_x_discrete(limits=slice(poverty_order,27:51)$State) +
scale_y_continuous(limits=c(0,22), labels=percent) +
ylab("Poverty Rate") +
theme_bw() +
coord_flip()
p2 <- ggplot(aes(x=State, y=PCTPOVALL_2014),
data=slice(poverty_order, 1:27)) +
geom_bar(stat='identity', fill="blue3") +
scale_x_discrete(limits=slice(poverty_order,1:27)$State) +
scale_y_continuous(limits=c(0,22)) +
ylab("Poverty Rate") +
theme_bw() +
coord_flip()
grid.arrange(p1, p2, ncol=2, top="Poverty Rates by State")
p1 <- ggplot(aes(x=State, y=PCTPOVALL_2014),
data=slice(poverty_order, 27:51)) +
geom_bar(stat='identity', fill="blue3") +
scale_x_discrete(limits=slice(poverty_order,27:51)$State) +
scale_y_continuous(limits=c(0,22), labels=percent) +
ylab("Poverty Rate") +
theme_bw() +
coord_flip()
percent <- function(x) {
return(paste(as.character(x), "%", sep=""))
}
p1 <- ggplot(aes(x=State, y=PCTPOVALL_2014),
data=slice(poverty_order, 27:51)) +
geom_bar(stat='identity', fill="blue3") +
scale_x_discrete(limits=slice(poverty_order,27:51)$State) +
scale_y_continuous(limits=c(0,22), labels=percent) +
ylab("Poverty Rate") +
theme_bw() +
coord_flip()
library(gridExtra)
percent <- function(x) {
return(paste(as.character(x), "%", sep=""))
}
p1 <- ggplot(aes(x=State, y=PCTPOVALL_2014),
data=slice(poverty_order, 27:51)) +
geom_bar(stat='identity', fill="blue3") +
scale_x_discrete(limits=slice(poverty_order,27:51)$State) +
scale_y_continuous(limits=c(0,22), labels=percent) +
ylab("Poverty Rate") +
theme_bw() +
coord_flip()
p2 <- ggplot(aes(x=State, y=PCTPOVALL_2014),
data=slice(poverty_order, 1:27)) +
geom_bar(stat='identity', fill="blue3") +
scale_x_discrete(limits=slice(poverty_order,1:27)$State) +
scale_y_continuous(limits=c(0,22), labels=percent) +
ylab("Poverty Rate") +
theme_bw() +
coord_flip()
grid.arrange(p1, p2, ncol=2, top="Poverty Rates by State")
ggplot(aes(x=long, y=lat, group=group, fill=max_inc),
data=max_unemployment_map) +
geom_polygon() +
coord_map() +
scale_fill_gradient(name="Unemployment\nIncrease") +
ggtitle("Highest Unemployment Increase During 2007-2011") +
theme_bw() +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
?scale_fill_gradient
ggplot(aes(x=long, y=lat, group=group, fill=max_inc),
data=max_unemployment_map) +
geom_polygon() +
coord_map() +
scale_fill_gradient(name="Unemployment\nIncrease", low="blue", high="red") +
ggtitle("Highest Unemployment Increase During 2007-2011") +
theme_bw() +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggplot(aes(x=long, y=lat, group=group, fill=max_inc),
data=max_unemployment_map) +
geom_polygon() +
coord_map() +
scale_fill_gradient(name="Unemployment\nIncrease", low="blue", high="red", labels=percent) +
ggtitle("Highest Unemployment Increase During 2007-2011") +
theme_bw() +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggplot(aes(x=long, y=lat, group=group, fill=max_inc),
data=max_unemployment_map) +
geom_polygon() +
coord_map() +
scale_fill_gradient(name="Unemployment\nIncrease", low="blue", high="red",\
labels=percent) +
ggtitle("Highest Unemployment Increase During 2007-2011") +
theme_bw() +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_text(size=12))
ggplot(aes(x=long, y=lat, group=group, fill=max_inc),
data=max_unemployment_map) +
geom_polygon() +
coord_map() +
scale_fill_gradient(name="Unemployment\nIncrease", low="blue", high="red",\
labels=percent) +
ggtitle("Highest Unemployment Increase During 2007-2011") +
theme_bw() +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_text(size=12))
ggplot(aes(x=long, y=lat, group=group, fill=max_inc),
data=max_unemployment_map) +
geom_polygon() +
coord_map() +
scale_fill_gradient(name="Unemployment\nIncrease", low="blue", high="red",
labels=percent) +
ggtitle("Highest Unemployment Increase During 2007-2011") +
theme_bw() +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_text(size=12))
ggplot(aes(x=long, y=lat, group=group, fill=max_inc),
data=max_unemployment_map) +
geom_polygon() +
coord_map() +
scale_fill_gradient(name="Unemployment\nIncrease", low="blue", high="red",
labels=percent) +
ggtitle("Highest Unemployment Increase During 2007-2011") +
theme_bw() +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_text(size=10),
legend.text = element_text(size=8))
fouryear <- mean_unemployment_education %>%
filter(amount == "4-Years College/Bachelor's")
ggplot(aes(x=year, y=mean_unemployment,
color=education_rate, group=education_rate),
data=fouryear) +
geom_line() +
theme_dark() +
xlab("Year") +
ylab("Unemployment Rate") +
scale_color_gradient(name="Education Rate") +
scale_x_discrete(limits=seq(from=2007,to=2015,by=1)) +
ggtitle("Yearly Unemployment Rates\nPer 4-Year College Education Rate")
?geom_smooth
ggplot(aes(x=year, y=mean_unemployment,
color=education_rate, group=education_rate),
data=fouryear) +
geom_point(size=0.3) +
geom_smooth(method="lm", se=FALSE, size=1) +
theme_dark() +
xlab("Year") +
ylab("Unemployment Rate") +
scale_color_gradient(name="Education Rate") +
scale_x_discrete(limits=seq(from=2007,to=2015,by=1)) +
ggtitle("Yearly Unemployment Rates\nPer 4-Year College Education Rate")
?geom_smooth
ggplot(aes(x=education_rate, y=mean_unemployment, color=factor(year) ), data=mean_unemployment_education) +
geom_point(size=0.3) +  geom_smooth(method = "lm", se = FALSE,size=1)  +
facet_wrap(~amount) +
scale_color_brewer(type='seq',
guide=guide_legend(title='year')) +
theme_dark() +
xlab("Year") +
ylab("Unemployment Rate") +
scale_color_gradient(name="Education Rate") +
scale_x_discrete(limits=seq(from=2007,to=2015,by=1)) +
ggtitle("Yearly Unemployment Rates\nPer 4-Year College Education Rate")
ggplot(aes(x=education_rate, y=mean_unemployment, color=factor(year) ), data=mean_unemployment_education) +
geom_point(size=0.3) +  geom_smooth(method = "lm", se = FALSE,size=1)  +
facet_wrap(~amount) +
scale_color_brewer(type='seq',
guide=guide_legend(title='year')) +
theme_dark() +
xlab("Year") +
ylab("Unemployment Rate") +
scale_color_gradient(name="Education Rate") +
scale_x_continuous(labels=percent) +
ggtitle("Yearly Unemployment Rates\nPer 4-Year College Education Rate")
ggplot(aes(x=education_rate, y=mean_unemployment, color=factor(year) ),
data=fouryear) +
geom_point(size=0.3) +  geom_smooth(method = "lm", se = FALSE,size=1)  +
facet_wrap(~amount) +
scale_color_brewer(type='seq', guide=guide_legend(title='year')) +
theme_dark() +
xlab("Year") +
ylab("Unemployment Rate") +
scale_color_gradient(name="Education Rate") +
scale_x_continuous(labels=percent) +
ggtitle("Yearly Unemployment Rates\nPer 4-Year College Education Rate")
ggplot(aes(x=education_rate, y=mean_unemployment, color=factor(year) ),
data=fouryear) +
geom_point(size=0.3) +
geom_smooth(method = "lm", se = FALSE,size=1)  +
facet_wrap(~amount) +
scale_color_brewer(type='seq', guide=guide_legend(title='year')) +
theme_dark() +
xlab("Year") +
ylab("Unemployment Rate") +
scale_x_continuous(labels=percent) +
ggtitle("Yearly Unemployment Rates\nPer 4-Year College Education Rate")
ggplot(aes(x=education_rate, y=mean_unemployment, color=factor(year) ),
data=fouryear) +
geom_point(size=0.3) +
geom_smooth(method = "lm", se = FALSE,size=1)  +
facet_wrap(~amount) +
scale_color_brewer(type='seq', guide=guide_legend(title='Year')) +
theme_dark() +
xlab("Education Rate") +
ylab("Unemployment Rate") +
scale_x_continuous(labels=percent) +
scale_y_continuous(labels=percent) +
ggtitle("Yearly Unemployment Rates\nPer 4-Year College Education Rate")
ggplot(aes(x=education_rate, y=mean_unemployment, color=factor(year) ),
data=fouryear) +
geom_point(size=0.3) +
geom_smooth(method = "lm", se = FALSE,size=1)  +
scale_color_brewer(type='seq', guide=guide_legend(title='Year')) +
theme_dark() +
xlab("Education Rate") +
ylab("Unemployment Rate") +
scale_x_continuous(labels=percent) +
scale_y_continuous(labels=percent) +
ggtitle("Yearly Unemployment Rates\nPer 4-Year College Education Rate")
ggplot(aes(x=education_rate, y=mean_unemployment, color=factor(year) ),
data=fouryear) +
geom_point(size=0.3, alpha=.5) +
geom_smooth(method = "lm", se = FALSE,size=1)  +
scale_color_brewer(type='seq', guide=guide_legend(title='Year')) +
theme_dark() +
xlab("Education Rate") +
ylab("Unemployment Rate") +
scale_x_continuous(labels=percent) +
scale_y_continuous(labels=percent) +
ggtitle("Yearly Unemployment Rates\nPer 4-Year College Education Rate")
ggplot(aes(x=education_rate, y=mean_unemployment, color=factor(year) ),
data=fouryear) +
geom_point(size=0.3, alpha=.25) +
geom_smooth(method = "lm", se = FALSE,size=1)  +
scale_color_brewer(type='seq', guide=guide_legend(title='Year')) +
theme_dark() +
xlab("Education Rate") +
ylab("Unemployment Rate") +
scale_x_continuous(labels=percent) +
scale_y_continuous(labels=percent) +
ggtitle("Yearly Unemployment Rates\nPer 4-Year College Education Rate")
ggplot(aes(x=education_rate, y=mean_unemployment, color=factor(year) ),
data=fouryear) +
geom_smooth(method = "lm", se = FALSE,size=1)  +
geom_point(size=0.3, alpha=1/3) +
scale_color_brewer(type='seq', guide=guide_legend(title='Year')) +
theme_dark() +
xlab("Education Rate") +
ylab("Unemployment Rate") +
scale_x_continuous(labels=percent) +
scale_y_continuous(labels=percent) +
ggtitle("Yearly Unemployment Rates\nPer 4-Year College Education Rate")
ggplot(aes(x=long, y=lat, group=group, fill=max_inc),
data=max_unemployment_map) +
geom_polygon() +
coord_map() +
scale_fill_gradient(name="Unemployment\nIncrease", low="blue", high="red",
labels=percent) +
ggtitle("Highest Unemployment Increase During 2007-2011") +
theme_bw() +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_text(size=10),
legend.text = element_text(size=8))
ggplot(aes(x=education_rate, y=mean_unemployment, color=factor(year) ),
data=fouryear) +
geom_point(size=0.3, alpha=1/3) +
geom_smooth(method = "lm", se = FALSE,size=1)  +
scale_color_brewer(type='seq', guide=guide_legend(title='Year')) +
theme_dark() +
xlab("Education Rate") +
ylab("Unemployment Rate") +
scale_x_continuous(labels=percent) +
scale_y_continuous(labels=percent) +
ggtitle("Yearly Unemployment Rates\nPer 4-Year College Education Rate")
unemployment_rates %>%
group_by(year) %>%
summarise(median_unemployment = median(unemployment_rate),
IQR_unemployment = IQR(unemployment_rate),
mean_unemployment = mean(unemployment_rate),
stddev_unemployment = sd(unemployment_rate))
unemployment_rates %>%
group_by(year) %>%
summarise(median_unemployment = median(rate),
IQR_unemployment = IQR(rate),
mean_unemployment = mean(rate),
stddev_unemployment = sd(rate))
